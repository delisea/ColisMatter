{"metadata":{"usedHelpers":[],"marked":[],"modules":{"imports":[],"exports":{"exported":[],"specifiers":[]}}},"options":{"filename":"/client/homeTemplate/homeTemplate.js","filenameRelative":"/client/homeTemplate/homeTemplate.js","env":{"development":{"plugins":[]}},"retainLines":false,"highlightCode":true,"suppressDeprecationMessages":false,"presets":[],"plugins":[[[],{"polyfill":false}],[[],null],[[],null],[[],{"allowTopLevelThis":true,"strict":false,"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],{"loose":true}],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],{"loose":true}],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null],[[],null]],"ignore":[],"code":true,"metadata":true,"ast":false,"comments":true,"compact":false,"minified":false,"sourceMap":true,"sourceMaps":true,"sourceMapTarget":"/client/homeTemplate/homeTemplate.js.map","sourceFileName":"/client/homeTemplate/homeTemplate.js","babelrc":false,"sourceType":"module","moduleIds":false,"passPerPreset":false,"parserOpts":false,"generatorOpts":false,"basename":"homeTemplate"},"ignored":false,"code":"Meteor.startup(function () {\n  /*$(window).resize(function() {\r\n    $('#map').css('height', window.innerHeight - 82 - 45);\r\n  });*/$(window).resize(); // trigger resize event \n}); // create marker collection\n\nvar Markers = new Meteor.Collection('markers');\nMeteor.subscribe('markers');\nvar map;\nvar markers;\n\nvar geoFitBounds = function (map, bbox) {\n  var b = L.latLngBounds(bbox);\n  pb = L.bounds(map.project(b.getSouthWest()), map.project(b.getNorthEast())), z = map.getBoundsZoom(b), c = b.getCenter(), pc = map.unproject(pb.getCenter());\n  map.setView(pc, z);\n  return map;\n};\n\nvar supportsOrientationChange = \"onorientationchange\" in window,\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\nwindow.addEventListener(orientationEvent, function () {\n  //console.log('HOLY ROTATING SCREENS BATMAN:' + window.orientation + \" \" + screen.width);\n  /*map.fitBounds([\r\n  \t[45.1667, 5.7667],\r\n  \t[45.184394, 5.752884]\r\n  ], {paddingTopLeft: [0, $(\".table-cell\").outerHeight()]});*/ //map.fitBounds(markers.getBounds().pad(0.5));\n  //console.log($(\".table-cell\").outerHeight());\n  /*console.log($(\"#map\").outerHeight());\r\n  map.fitBounds(markers.getBounds().pad(0.25));*/geoFitBounds(map, markers.getBounds().pad(1));\n}, false);\n\nTemplate.homeTemplate.rendered = function () {\n  L.Icon.Default.imagePath = '/packages/bevanhunt_leaflet/images/';\n  Markers.insert({\n    latlng: L.latLng(45.1667, 5.7667)\n  });\n  Markers.insert({\n    latlng: L.latLng(45.184394, 5.752884)\n  });\n  map = L.map('map', {\n    doubleClickZoom: false\n  }); //.setView([49.25044, -123.137], 13);\n  //console.log();\n  /*map.fitBounds([\r\n  [45.1667, 5.7667],\r\n  [45.184394, 5.752884]\r\n  ], {paddingTopLeft: [0, $(\".table-cell\").outerHeight()]});*/\n  console.log($(\".table-cell\").outerHeight());\n  L.tileLayer.provider('OpenStreetMap.Mapnik').addTo(map);\n  map.on('dblclick', function (event) {\n    Markers.insert({\n      latlng: event.latlng\n    });\n  }); // add clustermarkers\n\n  markers = L.markerClusterGroup();\n  map.addLayer(markers);\n  var query = Markers.find();\n  query.observe({\n    added: function (document) {\n      var marker = L.marker(document.latlng).addTo(map).on('click', function (event) {\n        map.removeLayer(marker);\n        Markers.remove({\n          _id: document._id\n        });\n      });\n      markers.addLayer(marker);\n    },\n    removed: function (oldDocument) {\n      layers = map._layers;\n      var key, val;\n\n      for (key in meteorBabelHelpers.sanitizeForInObject(layers)) {\n        val = layers[key];\n\n        if (val._latlng) {\n          if (val._latlng.lat === oldDocument.latlng.lat && val._latlng.lng === oldDocument.latlng.lng) {//map.removeLayer(val);\n          }\n        }\n      }\n    }\n  });\n  geoFitBounds(map, markers.getBounds().pad(1));\n};","ast":null,"map":{"version":3,"sources":["/client/homeTemplate/homeTemplate.js"],"names":["Meteor","startup","$","window","resize","Markers","Collection","subscribe","map","markers","geoFitBounds","bbox","b","L","latLngBounds","pb","bounds","project","getSouthWest","getNorthEast","z","getBoundsZoom","c","getCenter","pc","unproject","setView","supportsOrientationChange","orientationEvent","addEventListener","getBounds","pad","Template","homeTemplate","rendered","Icon","Default","imagePath","insert","latlng","latLng","doubleClickZoom","console","log","outerHeight","tileLayer","provider","addTo","on","event","markerClusterGroup","addLayer","query","find","observe","added","document","marker","removeLayer","remove","_id","removed","oldDocument","layers","_layers","key","val","_latlng","lat","lng"],"mappings":"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","file":"/client/homeTemplate/homeTemplate.js.map","sourcesContent":["Meteor.startup(function() {\r\n  /*$(window).resize(function() {\r\n    $('#map').css('height', window.innerHeight - 82 - 45);\r\n  });*/\r\n  $(window).resize(); // trigger resize event \r\n});\r\n \r\n// create marker collection\r\nvar Markers = new Meteor.Collection('markers');\r\n\r\nMeteor.subscribe('markers');\r\nvar map;\r\nvar markers;\r\n\r\nvar geoFitBounds = function(map, bbox) {\r\n        var b = L.latLngBounds(bbox);\r\n            pb = L.bounds(map.project(b.getSouthWest()), map.project(b.getNorthEast())),\r\n            z = map.getBoundsZoom(b),\r\n            c = b.getCenter(),\r\n            pc = map.unproject(pb.getCenter());\r\n\r\n        map.setView(pc, z);\r\n        return map;\r\n    };\r\n\r\nvar supportsOrientationChange = \"onorientationchange\" in window,\r\n    orientationEvent = supportsOrientationChange ? \"orientationchange\" : \"resize\";\r\n\r\nwindow.addEventListener(orientationEvent, function() {\r\n    //console.log('HOLY ROTATING SCREENS BATMAN:' + window.orientation + \" \" + screen.width);\r\n\t\r\n\t/*map.fitBounds([\r\n\t\t[45.1667, 5.7667],\r\n\t\t[45.184394, 5.752884]\r\n\t], {paddingTopLeft: [0, $(\".table-cell\").outerHeight()]});*/\r\n\t//map.fitBounds(markers.getBounds().pad(0.5));\r\n\t//console.log($(\".table-cell\").outerHeight());\r\n\t/*console.log($(\"#map\").outerHeight());\r\n\tmap.fitBounds(markers.getBounds().pad(0.25));*/\r\n\t\r\n\tgeoFitBounds(map, markers.getBounds().pad(1));\r\n}, false);\r\n\r\nTemplate.homeTemplate.rendered = function() {\r\n  L.Icon.Default.imagePath = '/packages/bevanhunt_leaflet/images/';\r\n  \r\n  Markers.insert({latlng: L.latLng(45.1667, 5.7667)});\r\n  Markers.insert({latlng: L.latLng(45.184394, 5.752884)});\r\n\r\n  map = L.map('map', {\r\n    doubleClickZoom: false\r\n  });//.setView([49.25044, -123.137], 13);\r\n\t//console.log();\r\n  \r\n  /*map.fitBounds([\r\n\t\t[45.1667, 5.7667],\r\n\t\t[45.184394, 5.752884]\r\n\t], {paddingTopLeft: [0, $(\".table-cell\").outerHeight()]});*/\r\n\t\r\n\tconsole.log($(\".table-cell\").outerHeight());\r\n\t\r\n\r\n  L.tileLayer.provider('OpenStreetMap.Mapnik').addTo(map);\r\n\r\n  map.on('dblclick', function(event) {\r\n    Markers.insert({latlng: event.latlng});\r\n  });\r\n\r\n  // add clustermarkers\r\n  markers = L.markerClusterGroup();\r\n  map.addLayer(markers);\r\n\r\n  var query = Markers.find();\r\n  query.observe({\r\n    added: function (document) {\r\n      var marker = L.marker(document.latlng).addTo(map)\r\n        .on('click', function(event) {\r\n          map.removeLayer(marker);\r\n          Markers.remove({_id: document._id});\r\n        });\r\n       markers.addLayer(marker);\r\n    },\r\n    removed: function (oldDocument) {\r\n      layers = map._layers;\r\n      var key, val;\r\n      for (key in layers) {\r\n        val = layers[key];\r\n        if (val._latlng) {\r\n          if (val._latlng.lat === oldDocument.latlng.lat && val._latlng.lng === oldDocument.latlng.lng) {\r\n            //map.removeLayer(val);\r\n          }\r\n        }\r\n      }\r\n    }\r\n  });\r\n\tgeoFitBounds(map, markers.getBounds().pad(1));\r\n};"]},"hash":"b9c3bc5f1e61a4dfe65ec896c1d94bb28d1d1628"}
